# バグ修正計画 (Tasks for Bug Fixes)

このドキュメントは、`pickit` プロジェクトにおける主要な機能追加とは異なる不具合修正に関する計画を管理します。機能追加については `prompt/plan.md` を参照してください。

各不具合修正は、以下の形式で記述されます。

## 課題/不具合 #[Issue Number] - [簡潔な説明]

-   **説明:** 発生している不具合の具体的な内容、再現手順、および期待される動作。
-   **影響範囲:** 不具合が影響を及ぼすモジュール、機能、またはユーザーエクスペリエンス。
-   **優先度:** (例: 高, 中, 低) - 修正の緊急性。
-   **提案される修正アプローチ:** 不具合を解決するための具体的な方法や検討事項。
-   **ステータス:** (例: 未着手, 調査中, 修正中, レビュー待ち, 完了)

---

### 例: 課題/不具合 #123 - Gitモジュールでの日本語パス処理の不具合

-   **説明:** Gitモジュールが日本語を含むファイルパスを正しく扱えず、ファイルツリーの表示や操作でエラーが発生する。具体的には、`git status` の出力で日本語部分が文字化けしたり、ファイルが見つからないというエラーになる。
-   **影響範囲:** Gitモジュール全般、特にファイルツリー表示、選択、操作に関わる部分。日本語環境のユーザー。
-   **優先度:** 高
-   **提案される修正アプローチ:**
    -   Rustの `std::process::Command` で `git` コマンドを実行する際に、環境変数 `LANG` や `LC_ALL` を `C.UTF-8` または適切なUTF-8ロケールに設定して実行することを検討。
    -   Gitコマンドの出力をUTF-8としてデコードする処理の確認と修正。
    -   OSレベルでのパスエンコーディングの違い（WindowsとLinux/macOS）を考慮したテストの追加。
-   **ステータス:** 未着手

---



### 課題/不具合 #XXX - TUI表示色の修正



-   **説明:** Gitのチェックアウト情報が上位にも下位にも存在しないディレクトリ（明示的なチェックアウトがないディレクトリ）が白色で表示されている。本来、これらのディレクトリは間接的にチェックアウトされていない状態を示すために灰色で表示されるべきだが、現在の白色表示ではその状態が正しく伝わらない。結果として、ユーザーが未チェックアウトのディレクトリを識別できなくなっている。

-   **影響範囲:** TUIのUI表示全般、ユーザーエクスペリエンス。

-   **優先度:** 中

-   **提案される修正アプローチ:**
    -   ディレクトリの表示色を決定するロジックを見直す。
    -   特に、ルートノード（最上位ディレクトリ）のチェックアウト状態が、その下位ディレクトリの表示色に与える影響を調査する。
    -   Gitのチェックアウト情報が上位にも下位にも存在しないディレクトリを正しく判定するロジックを実装する。
    -   上記の条件に一致するディレクトリに対して、Ratatuiのスタイルで明示的に灰色（Gray）を指定する。
    -   この状態をテストするためのユニットテストまたは結合テストを追加する。

-   **チェックリスト:**
    -   [x] ディレクトリ表示色のロジックをレビュー
    -   [x] ルートノードのチェックアウト状態が下位に与える影響を調査・特定
    -   [x] 間接的にチェックアウトされていない状態を判定するロジックを実装
    -   [x] 判定ロジックに基づき、対象ディレクトリを灰色で表示するよう修正
    -   [x] 上記の状態を検証するテストケースを追加

-   **ステータス:** 未着手



---



## 課題/不具合 #[Issue Number] - [簡潔な説明]



-   **説明:**
-   **影響範囲:**
-   **優先度:**
-   **提案される修正アプローチ:**
-   **ステータス:**
